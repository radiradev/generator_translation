GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/eos/user/r/rradev/new_parquet/test_file_flat_argon_12_GENIEv2_3.parquet
/eos/user/r/rradev/new_parquet/test_file_flat_argon_12_GENIEv3_G18_10b_9.parquet
Sanity Checking DataLoader 0:   0%|                                                                                                                                                                                                                            | 0/1954 [00:00<?, ?it/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name | Type                | Params
---------------------------------------------
0 | net  | ParticleFlowNetwork | 58.4 K
1 | loss | CrossEntropyLoss    | 0
---------------------------------------------
58.4 K    Trainable params
0         Non-trainable params
58.4 K    Total params
0.233     Total estimated model params size (MB)
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:236: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/data/rradev/generator_reweight/models/model.py:146: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probas = F.softmax(y_hat)
/data/rradev/generator_reweight/models/model.py:37: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  features = torch.tensor(batch['features'], dtype=torch.float)
/data/rradev/generator_reweight/models/model.py:34: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(labels, dtype=torch.long)
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Torchmetrics v0.9 introduced a new argument class property called `full_state_update` that has
                not been set for this class (_ResultMetric). The property determines if `update` by
                default needs access to the full metric state. If this is not the case, significant speedups can be
                achieved and we recommend setting this to `False`.
                We provide an checking function
                `from torchmetrics.utilities import check_forward_no_full_state`
                that can be used to check if the `full_state_update=True` (old and potential slower behaviour,
                default for now) or if `full_state_update=False` can be used safely.
  warnings.warn(*args, **kwargs)
/data/rradev/generator_reweight/models/model.py:46: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc = accuracy(predictions, torch.tensor(labels, dtype=torch.int32))
/data/rradev/generator_reweight/models/model.py:47: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).








Sanity Checking DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:20<00:00, 95.73it/s]
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/plotly/graph_objs/_deprecations.py:378: DeprecationWarning: plotly.graph_objs.Line is deprecated.
Please replace it with one of the following more specific types
  - plotly.graph_objs.scatter.Line
  - plotly.graph_objs.layout.shape.Line
  - etc.
  warnings.warn(
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/plotly/graph_objs/_deprecations.py:378: DeprecationWarning:
plotly.graph_objs.Line is deprecated.
Please replace it with one of the following more specific types
  - plotly.graph_objs.scatter.Line
  - plotly.graph_objs.layout.shape.Line

/eos/user/r/rradev/new_parquet/train_file_flat_argon_12_GENIEv2_17.parquet
/eos/user/r/rradev/new_parquet/train_file_flat_argon_12_GENIEv3_G18_10b_9.parquet
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:236: PossibleUserWarning:
The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
/data/rradev/generator_reweight/models/model.py:37: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/data/rradev/generator_reweight/models/model.py:34: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning:
Torchmetrics v0.9 introduced a new argument class property called `full_state_update` that has
                not been set for this class (_ResultMetric). The property determines if `update` by
                default needs access to the full metric state. If this is not the case, significant speedups can be
                achieved and we recommend setting this to `False`.
                We provide an checking function
                `from torchmetrics.utilities import check_forward_no_full_state`
                that can be used to check if the `full_state_update=True` (old and potential slower behaviour,
                default for now) or if `full_state_update=False` can be used safely.
/data/rradev/generator_reweight/models/model.py:46: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/data/rradev/generator_reweight/models/model.py:47: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:231: UserWarning:
You called `self.log('positive_examples', ...)` in your `training_step` but the value needs to be floating point. Converting it to torch.float32.








Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:30<00:00, 64.22it/s, loss=0.639, v_num=pwof]/eos/user/r/rradev/new_parquet/train_file_flat_argon_12_GENIEv2_15.parquet
/eos/user/r/rradev/new_parquet/train_file_flat_argon_12_GENIEv3_G18_10b_34.parquet







Epoch 1:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 1750/1954 [00:27<00:03, 64.15it/s, loss=0.616, v_num=pwof]
`Trainer.fit` stopped: `max_epochs=2` reached.
FIT Profiler Report
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                                     	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                                      	|  -              	|  238530         	|  125.04         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                                         	|  30.478         	|  2              	|  60.956         	|  48.749         	|
|  run_training_batch                                                                                                                                                                                                         	|  0.01227        	|  3908           	|  47.95          	|  38.348         	|
|  [LightningModule]LightningModel.optimizer_step                                                                                                                                                                             	|  0.011975       	|  3908           	|  46.799         	|  37.427         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                                                               	|  0.0060107      	|  3908           	|  23.49          	|  18.786         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                                                                    	|  0.0042681      	|  3908           	|  16.68          	|  13.34          	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                                                                             	|  0.0078044      	|  1954           	|  15.25          	|  12.196         	|
|  [LightningDataModule]DataModule.setup                                                                                                                                                                                      	|  11.833         	|  1              	|  11.833         	|  9.4635         	|
|  [TrainingEpochLoop].train_dataloader_next                                                                                                                                                                                  	|  0.0014275      	|  3908           	|  5.5786         	|  4.4614         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                                                                             	|  0.00087028     	|  5862           	|  5.1016         	|  4.0799         	|
|  [LightningModule]LightningModel.transfer_batch_to_device                                                                                                                                                                   	|  0.00077829     	|  5862           	|  4.5623         	|  3.6487         	|
|  [EvaluationEpochLoop].None_dataloader_idx_0_next                                                                                                                                                                           	|  0.0012392      	|  1954           	|  2.4214         	|  1.9365         	|
|  [LightningModule]LightningModel.optimizer_zero_grad                                                                                                                                                                        	|  0.0001659      	|  3908           	|  0.64833        	|  0.5185         	|
|  [LightningModule]LightningModel.validation_epoch_end                                                                                                                                                                       	|  0.64662        	|  1              	|  0.64662        	|  0.51713        	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_end                	|  2.2993e-05     	|  3908           	|  0.089858       	|  0.071863       	|
|  [LightningModule]LightningModel.configure_gradient_clipping                                                                                                                                                                	|  2.0279e-05     	|  3908           	|  0.079251       	|  0.063381       	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                                                                               	|  1.6677e-05     	|  3908           	|  0.065175       	|  0.052123       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                                          	|  1.8745e-05     	|  1954           	|  0.036627       	|  0.029292       	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                                              	|  4.4166e-06     	|  3908           	|  0.01726        	|  0.013804       	|
|  [Callback]TQDMProgressBar.on_batch_start                                                                                                                                                                                   	|  4.1704e-06     	|  3908           	|  0.016298       	|  0.013034       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                                                	|  4.0917e-06     	|  3908           	|  0.01599        	|  0.012788       	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                                                                                  	|  3.3626e-06     	|  3908           	|  0.013141       	|  0.01051        	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                                               	|  3.3554e-06     	|  3908           	|  0.013113       	|  0.010487       	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                                                 	|  3.0703e-06     	|  3908           	|  0.011999       	|  0.0095958      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                                                                             	|  3.0077e-06     	|  3908           	|  0.011754       	|  0.0094002      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                                        	|  5.863e-06      	|  1954           	|  0.011456       	|  0.0091622      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                                         	|  2.8736e-06     	|  3908           	|  0.01123        	|  0.0089811      	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                                                                                  	|  2.7496e-06     	|  3908           	|  0.010745       	|  0.0085935      	|
|  [Callback]TQDMProgressBar.on_batch_end                                                                                                                                                                                     	|  2.7494e-06     	|  3908           	|  0.010745       	|  0.0085929      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                                                                                   	|  2.719e-06      	|  3908           	|  0.010626       	|  0.008498       	|
|  [Callback]ModelSummary.on_batch_start                                                                                                                                                                                      	|  2.7019e-06     	|  3908           	|  0.010559       	|  0.0084444      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_zero_grad               	|  2.6531e-06     	|  3908           	|  0.010368       	|  0.0082921      	|
|  [Callback]GradientAccumulationScheduler.on_train_batch_end                                                                                                                                                                 	|  2.6508e-06     	|  3908           	|  0.010359       	|  0.0082849      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_start              	|  2.6381e-06     	|  3908           	|  0.01031        	|  0.0082452      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_optimizer_step          	|  2.5984e-06     	|  3908           	|  0.010155       	|  0.0081212      	|
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                                                	|  2.5783e-06     	|  3908           	|  0.010076       	|  0.0080583      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                                                                                	|  2.5566e-06     	|  3908           	|  0.0099913      	|  0.0079905      	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                                  	|  2.533e-06      	|  3908           	|  0.0098989      	|  0.0079166      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_backward                	|  2.5318e-06     	|  3908           	|  0.0098942      	|  0.0079129      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                                            	|  2.5248e-06     	|  3908           	|  0.0098671      	|  0.0078912      	|
|  [Callback]GradientAccumulationScheduler.on_train_batch_start                                                                                                                                                               	|  2.5246e-06     	|  3908           	|  0.0098662      	|  0.0078905      	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                                           	|  2.5227e-06     	|  3908           	|  0.0098588      	|  0.0078845      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_batch_start                    	|  2.512e-06      	|  3908           	|  0.0098168      	|  0.0078509      	|
|  [LightningModule]LightningModel.on_before_batch_transfer                                                                                                                                                                   	|  1.6622e-06     	|  5862           	|  0.009744       	|  0.0077927      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_after_backward                 	|  2.459e-06      	|  3908           	|  0.0096096      	|  0.0076852      	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                                 	|  2.451e-06      	|  3908           	|  0.0095784      	|  0.0076603      	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                                     	|  2.4451e-06     	|  3908           	|  0.0095555      	|  0.007642       	|
|  [LightningModule]LightningModel.on_after_batch_transfer                                                                                                                                                                    	|  1.6207e-06     	|  5862           	|  0.0095007      	|  0.0075982      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_batch_end                      	|  2.4066e-06     	|  3908           	|  0.0094049      	|  0.0075215      	|
|  [Callback]ModelSummary.on_batch_end                                                                                                                                                                                        	|  2.3879e-06     	|  3908           	|  0.0093319      	|  0.0074632      	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                                       	|  2.3307e-06     	|  3908           	|  0.0091085      	|  0.0072845      	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                                             	|  3.2481e-06     	|  1954           	|  0.0063467      	|  0.0050758      	|
|  [LightningModule]LightningModel.training_step_end                                                                                                                                                                          	|  1.5674e-06     	|  3908           	|  0.0061254      	|  0.0048988      	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                                           	|  2.9914e-06     	|  1954           	|  0.0058452      	|  0.0046747      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                                            	|  2.7236e-06     	|  1954           	|  0.0053218      	|  0.0042561      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_end           	|  2.6936e-06     	|  1954           	|  0.0052633      	|  0.0042093      	|
|  [LightningModule]LightningModel.on_train_batch_end                                                                                                                                                                         	|  1.3144e-06     	|  3908           	|  0.0051367      	|  0.004108       	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_start         	|  2.6212e-06     	|  1954           	|  0.0051217      	|  0.0040961      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                                          	|  2.5906e-06     	|  1954           	|  0.005062       	|  0.0040483      	|
|  [LightningModule]LightningModel.on_train_batch_start                                                                                                                                                                       	|  1.0505e-06     	|  3908           	|  0.0041053      	|  0.0032832      	|
|  [LightningModule]LightningModel.on_after_backward                                                                                                                                                                          	|  1.0342e-06     	|  3908           	|  0.0040417      	|  0.0032323      	|
|  [LightningModule]LightningModel.on_before_zero_grad                                                                                                                                                                        	|  1.0305e-06     	|  3908           	|  0.0040274      	|  0.0032209      	|
|  [Strategy]SingleDeviceStrategy.training_step_end                                                                                                                                                                           	|  1.0295e-06     	|  3908           	|  0.0040234      	|  0.0032177      	|
|  [LightningModule]LightningModel.on_before_backward                                                                                                                                                                         	|  1.0061e-06     	|  3908           	|  0.003932       	|  0.0031446      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                                                                        	|  9.1183e-07     	|  3908           	|  0.0035634      	|  0.0028498      	|
|  [LightningModule]LightningModel.validation_step_end                                                                                                                                                                        	|  1.7551e-06     	|  1954           	|  0.0034295      	|  0.0027428      	|
|  [LightningModule]LightningModel.on_before_optimizer_step                                                                                                                                                                   	|  8.6422e-07     	|  3908           	|  0.0033774      	|  0.002701       	|
|  [Strategy]SingleDeviceStrategy.validation_step_end                                                                                                                                                                         	|  1.1115e-06     	|  1954           	|  0.0021718      	|  0.0017369      	|
|  [LightningModule]LightningModel.on_validation_batch_end                                                                                                                                                                    	|  1.1025e-06     	|  1954           	|  0.0021544      	|  0.0017229      	|
|  [LightningModule]LightningModel.on_validation_batch_start                                                                                                                                                                  	|  1.015e-06      	|  1954           	|  0.0019833      	|  0.0015862      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                                             	|  0.00092886     	|  2              	|  0.0018577      	|  0.0014857      	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                                                                        	|  0.0015418      	|  1              	|  0.0015418      	|  0.0012331      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                                            	|  0.0014204      	|  1              	|  0.0014204      	|  0.001136       	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                                               	|  0.00056033     	|  2              	|  0.0011207      	|  0.00089624     	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                                                	|  0.00097996     	|  1              	|  0.00097996     	|  0.00078372     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                                                     	|  0.0005987      	|  1              	|  0.0005987      	|  0.00047881     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                                                   	|  0.00058483     	|  1              	|  0.00058483     	|  0.00046771     	|
|  [LightningModule]LightningModel.configure_optimizers                                                                                                                                                                       	|  0.00041993     	|  1              	|  0.00041993     	|  0.00033583     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.00035084     	|  1              	|  0.00035084     	|  0.00028058     	|
|  [LightningModule]LightningModel.on_validation_model_train                                                                                                                                                                  	|  0.00021351     	|  1              	|  0.00021351     	|  0.00017076     	|
|  [LightningModule]LightningModel.on_validation_model_eval                                                                                                                                                                   	|  0.00017501     	|  1              	|  0.00017501     	|  0.00013996     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_end                	|  2.5308e-05     	|  2              	|  5.0617e-05     	|  4.0481e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_end                 	|  4.9894e-05     	|  1              	|  4.9894e-05     	|  3.9902e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                                                  	|  1.8267e-05     	|  2              	|  3.6535e-05     	|  2.9219e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                                  	|  3.349e-05      	|  1              	|  3.349e-05      	|  2.6783e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                                          	|  2.8232e-05     	|  1              	|  2.8232e-05     	|  2.2578e-05     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                                                                   	|  2.6772e-05     	|  1              	|  2.6772e-05     	|  2.1411e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                                                	|  1.2191e-05     	|  2              	|  2.4381e-05     	|  1.9499e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                                     	|  7.3897e-06     	|  3              	|  2.2169e-05     	|  1.773e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_epoch_end                      	|  6.9077e-06     	|  3              	|  2.0723e-05     	|  1.6573e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                                               	|  9.1675e-06     	|  2              	|  1.8335e-05     	|  1.4663e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                                            	|  1.6861e-05     	|  1              	|  1.6861e-05     	|  1.3484e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                                   	|  5.44e-06       	|  3              	|  1.632e-05      	|  1.3052e-05     	|
|  [LightningModule]LightningModel.on_validation_epoch_end                                                                                                                                                                    	|  1.5105e-05     	|  1              	|  1.5105e-05     	|  1.208e-05      	|
|  [LightningModule]LightningModel.on_epoch_end                                                                                                                                                                               	|  4.9123e-06     	|  3              	|  1.4737e-05     	|  1.1786e-05     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                                       	|  1.305e-05      	|  1              	|  1.305e-05      	|  1.0437e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                                                                           	|  1.239e-05      	|  1              	|  1.239e-05      	|  9.9088e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                                               	|  1.1427e-05     	|  1              	|  1.1427e-05     	|  9.1387e-06     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                                        	|  3.6497e-06     	|  3              	|  1.0949e-05     	|  8.7564e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                                                                      	|  1.0586e-05     	|  1              	|  1.0586e-05     	|  8.4661e-06     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                                                                        	|  9.8e-06        	|  1              	|  9.8e-06        	|  7.8375e-06     	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                                              	|  9.733e-06      	|  1              	|  9.733e-06      	|  7.7839e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                                 	|  4.599e-06      	|  2              	|  9.198e-06      	|  7.356e-06      	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                                                     	|  9.105e-06      	|  1              	|  9.105e-06      	|  7.2817e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                                              	|  8.447e-06      	|  1              	|  8.447e-06      	|  6.7554e-06     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                                      	|  2.7517e-06     	|  3              	|  8.255e-06      	|  6.6019e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_epoch_start                    	|  2.639e-06      	|  3              	|  7.917e-06      	|  6.3316e-06     	|
|  [LightningModule]LightningModel.configure_callbacks                                                                                                                                                                        	|  7.463e-06      	|  1              	|  7.463e-06      	|  5.9685e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                                     	|  2.485e-06      	|  3              	|  7.455e-06      	|  5.9621e-06     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                                       	|  7.35e-06       	|  1              	|  7.35e-06       	|  5.8781e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                                       	|  2.4277e-06     	|  3              	|  7.283e-06      	|  5.8245e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_start              	|  2.841e-06      	|  2              	|  5.682e-06      	|  4.5441e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_start                                                                                                                                                                        	|  5.529e-06      	|  1              	|  5.529e-06      	|  4.4218e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                                         	|  5.4e-06        	|  1              	|  5.4e-06        	|  4.3186e-06     	|
|  [LightningModule]LightningModel.on_epoch_start                                                                                                                                                                             	|  1.7463e-06     	|  3              	|  5.239e-06      	|  4.1899e-06     	|
|  [LightningDataModule]DataModule.prepare_data                                                                                                                                                                               	|  5.152e-06      	|  1              	|  5.152e-06      	|  4.1203e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                                               	|  4.781e-06      	|  1              	|  4.781e-06      	|  3.8236e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_start                    	|  4.723e-06      	|  1              	|  4.723e-06      	|  3.7772e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_start                      	|  4.659e-06      	|  1              	|  4.659e-06      	|  3.726e-06      	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                                             	|  4.645e-06      	|  1              	|  4.645e-06      	|  3.7148e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                                        	|  4.482e-06      	|  1              	|  4.482e-06      	|  3.5845e-06     	|
|  [LightningModule]LightningModel.on_fit_start                                                                                                                                                                               	|  4.47e-06       	|  1              	|  4.47e-06       	|  3.5749e-06     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                                                                 	|  4.079e-06      	|  1              	|  4.079e-06      	|  3.2622e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                                       	|  3.926e-06      	|  1              	|  3.926e-06      	|  3.1398e-06     	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                                              	|  3.484e-06      	|  1              	|  3.484e-06      	|  2.7863e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_start                                                                                                                                                                           	|  3.363e-06      	|  1              	|  3.363e-06      	|  2.6895e-06     	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                                              	|  3.347e-06      	|  1              	|  3.347e-06      	|  2.6767e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                                              	|  3.323e-06      	|  1              	|  3.323e-06      	|  2.6575e-06     	|
|  [LightningModule]LightningModel.on_train_epoch_start                                                                                                                                                                       	|  1.641e-06      	|  2              	|  3.282e-06      	|  2.6248e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                                       	|  3.241e-06      	|  1              	|  3.241e-06      	|  2.592e-06      	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                                          	|  3.138e-06      	|  1              	|  3.138e-06      	|  2.5096e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_start             	|  3.135e-06      	|  1              	|  3.135e-06      	|  2.5072e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                                                                          	|  3.069e-06      	|  1              	|  3.069e-06      	|  2.4544e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  2.997e-06      	|  1              	|  2.997e-06      	|  2.3968e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_end                      	|  2.958e-06      	|  1              	|  2.958e-06      	|  2.3656e-06     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                                                 	|  2.951e-06      	|  1              	|  2.951e-06      	|  2.36e-06       	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                                            	|  2.947e-06      	|  1              	|  2.947e-06      	|  2.3568e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_end                                                                                                                                                                          	|  2.927e-06      	|  1              	|  2.927e-06      	|  2.3408e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                                     	|  2.899e-06      	|  1              	|  2.899e-06      	|  2.3185e-06     	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                                 	|  2.885e-06      	|  1              	|  2.885e-06      	|  2.3073e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_end                                                                                                                                                                             	|  2.82e-06       	|  1              	|  2.82e-06       	|  2.2553e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                                            	|  2.777e-06      	|  1              	|  2.777e-06      	|  2.2209e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_start               	|  2.763e-06      	|  1              	|  2.763e-06      	|  2.2097e-06     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                                                	|  2.737e-06      	|  1              	|  2.737e-06      	|  2.1889e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                                                	|  2.737e-06      	|  1              	|  2.737e-06      	|  2.1889e-06     	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                                         	|  2.715e-06      	|  1              	|  2.715e-06      	|  2.1713e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                                          	|  2.702e-06      	|  1              	|  2.702e-06      	|  2.1609e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                                           	|  2.686e-06      	|  1              	|  2.686e-06      	|  2.1481e-06     	|
|  [LightningModule]LightningModel.on_train_epoch_end                                                                                                                                                                         	|  1.333e-06      	|  2              	|  2.666e-06      	|  2.1321e-06     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                                           	|  2.662e-06      	|  1              	|  2.662e-06      	|  2.1289e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_end               	|  2.656e-06      	|  1              	|  2.656e-06      	|  2.1241e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_pretrain_routine_start         	|  2.631e-06      	|  1              	|  2.631e-06      	|  2.1041e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                                            	|  2.606e-06      	|  1              	|  2.606e-06      	|  2.0841e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_pretrain_routine_end           	|  2.601e-06      	|  1              	|  2.601e-06      	|  2.0801e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                                         	|  2.595e-06      	|  1              	|  2.595e-06      	|  2.0753e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                                                	|  2.595e-06      	|  1              	|  2.595e-06      	|  2.0753e-06     	|
|  [LightningModule]LightningModel.setup                                                                                                                                                                                      	|  2.585e-06      	|  1              	|  2.585e-06      	|  2.0673e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_end           	|  2.55e-06       	|  1              	|  2.55e-06       	|  2.0393e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_configure_sharded_model        	|  2.532e-06      	|  1              	|  2.532e-06      	|  2.025e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_start         	|  2.5e-06        	|  1              	|  2.5e-06        	|  1.9994e-06     	|
|  [LightningModule]LightningModel.configure_sharded_model                                                                                                                                                                    	|  2.486e-06      	|  1              	|  2.486e-06      	|  1.9882e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                                          	|  2.484e-06      	|  1              	|  2.484e-06      	|  1.9866e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.teardown                          	|  2.481e-06      	|  1              	|  2.481e-06      	|  1.9842e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_end                        	|  2.321e-06      	|  1              	|  2.321e-06      	|  1.8562e-06     	|
|  [LightningModule]LightningModel.on_fit_end                                                                                                                                                                                 	|  1.709e-06      	|  1              	|  1.709e-06      	|  1.3668e-06     	|
|  [LightningDataModule]DataModule.teardown                                                                                                                                                                                   	|  1.709e-06      	|  1              	|  1.709e-06      	|  1.3668e-06     	|
|  [LightningModule]LightningModel.on_validation_end                                                                                                                                                                          	|  1.688e-06      	|  1              	|  1.688e-06      	|  1.35e-06       	|
|  [LightningModule]LightningModel.on_train_start                                                                                                                                                                             	|  1.678e-06      	|  1              	|  1.678e-06      	|  1.342e-06      	|
|  [LightningModule]LightningModel.on_train_end                                                                                                                                                                               	|  1.546e-06      	|  1              	|  1.546e-06      	|  1.2364e-06     	|
|  [LightningModule]LightningModel.on_validation_start                                                                                                                                                                        	|  1.362e-06      	|  1              	|  1.362e-06      	|  1.0892e-06     	|
|  [LightningModule]LightningModel.on_pretrain_routine_start                                                                                                                                                                  	|  1.303e-06      	|  1              	|  1.303e-06      	|  1.0421e-06     	|
|  [LightningModule]LightningModel.on_validation_epoch_start                                                                                                                                                                  	|  1.243e-06      	|  1              	|  1.243e-06      	|  9.9408e-07     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                                                                         	|  1.224e-06      	|  1              	|  1.224e-06      	|  9.7889e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                                                                              	|  1.216e-06      	|  1              	|  1.216e-06      	|  9.7249e-07     	|
|  [LightningModule]LightningModel.prepare_data                                                                                                                                                                               	|  1.104e-06      	|  1              	|  1.104e-06      	|  8.8292e-07     	|
|  [LightningModule]LightningModel.on_pretrain_routine_end                                                                                                                                                                    	|  1.073e-06      	|  1              	|  1.073e-06      	|  8.5813e-07     	|
|  [LightningModule]LightningModel.teardown                                                                                                                                                                                   	|  1.064e-06      	|  1              	|  1.064e-06      	|  8.5093e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                                                                	|  9.9e-07        	|  1              	|  9.9e-07        	|  7.9175e-07     	|

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:30<00:00, 64.00it/s, loss=0.611, v_num=pwof]