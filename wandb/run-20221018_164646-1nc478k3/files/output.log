GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv2_1M_046_NUISFLAT.root
Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv3_G18_10b_00_000_1M_043_NUISFLAT.root
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name | Type                | Params
---------------------------------------------
0 | net  | ParticleFlowNetwork | 58.4 K
1 | loss | CrossEntropyLoss    | 0
---------------------------------------------
58.4 K    Trainable params
0         Non-trainable params
58.4 K    Total params
0.233     Total estimated model params size (MB)
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:236: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Sanity Checking DataLoader 0:   0%|                                                                                                                                                                                                                            | 0/1954 [00:00<?, ?it/s]
/data/rradev/generator_reweight/models/model.py:146: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  probas = F.softmax(y_hat)
/data/rradev/generator_reweight/models/model.py:37: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  features = torch.tensor(batch['features'], dtype=torch.float)
/data/rradev/generator_reweight/models/model.py:34: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(labels, dtype=torch.long)
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Torchmetrics v0.9 introduced a new argument class property called `full_state_update` that has
                not been set for this class (_ResultMetric). The property determines if `update` by
                default needs access to the full metric state. If this is not the case, significant speedups can be
                achieved and we recommend setting this to `False`.
                We provide an checking function
                `from torchmetrics.utilities import check_forward_no_full_state`
                that can be used to check if the `full_state_update=True` (old and potential slower behaviour,
                default for now) or if `full_state_update=False` can be used safely.
  warnings.warn(*args, **kwargs)
/data/rradev/generator_reweight/models/model.py:46: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc = accuracy(predictions, torch.tensor(labels, dtype=torch.int32))
/data/rradev/generator_reweight/models/model.py:47: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).








Sanity Checking DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:20<00:00, 94.62it/s]
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/plotly/graph_objs/_deprecations.py:378: DeprecationWarning: plotly.graph_objs.Line is deprecated.
Please replace it with one of the following more specific types
  - plotly.graph_objs.scatter.Line
  - plotly.graph_objs.layout.shape.Line
  - etc.
  warnings.warn(
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/plotly/graph_objs/_deprecations.py:378: DeprecationWarning:
plotly.graph_objs.Line is deprecated.
Please replace it with one of the following more specific types
  - plotly.graph_objs.scatter.Line
  - plotly.graph_objs.layout.shape.Line

Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv2_1M_015_NUISFLAT.root
Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv3_G18_10b_00_000_1M_020_NUISFLAT.root
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:236: PossibleUserWarning:
The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
Epoch 0:   0%|                                                                                                                                                                                                                                                 | 0/1954 [00:00<?, ?it/s]
/data/rradev/generator_reweight/models/model.py:37: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/data/rradev/generator_reweight/models/model.py:34: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning:
Torchmetrics v0.9 introduced a new argument class property called `full_state_update` that has
                not been set for this class (_ResultMetric). The property determines if `update` by
                default needs access to the full metric state. If this is not the case, significant speedups can be
                achieved and we recommend setting this to `False`.
                We provide an checking function
                `from torchmetrics.utilities import check_forward_no_full_state`
                that can be used to check if the `full_state_update=True` (old and potential slower behaviour,
                default for now) or if `full_state_update=False` can be used safely.
/data/rradev/generator_reweight/models/model.py:46: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/data/rradev/generator_reweight/models/model.py:47: UserWarning:
To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
/afs/cern.ch/user/r/rradev/envs/generator_translation/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:231: UserWarning:








Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:37<00:00, 51.52it/s, loss=0.637, v_num=78k3]Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv2_1M_020_NUISFLAT.root
Loaded Filename /eos/home-c/cristova/DUNE/AlternateGenerators/flat_argon_12_GENIEv3_G18_10b_00_000_1M_006_NUISFLAT.root







Epoch 1:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 1750/1954 [00:31<00:03, 56.25it/s, loss=0.612, v_num=78k3]
`Trainer.fit` stopped: `max_epochs=2` reached.
FIT Profiler Report
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                                     	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                                      	|  -              	|  238530         	|  163.93         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                                         	|  36.004         	|  2              	|  72.008         	|  43.927         	|
|  run_training_batch                                                                                                                                                                                                         	|  0.014398       	|  3908           	|  56.267         	|  34.324         	|
|  [LightningModule]LightningModel.optimizer_step                                                                                                                                                                             	|  0.014099       	|  3908           	|  55.1           	|  33.612         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                                                               	|  0.0063886      	|  3908           	|  24.967         	|  15.23          	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                                                                    	|  0.0058026      	|  3908           	|  22.676         	|  13.833         	|
|  [LightningDataModule]DataModule.setup                                                                                                                                                                                      	|  19.84          	|  1              	|  19.84          	|  12.103         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                                                                             	|  0.0078331      	|  1954           	|  15.306         	|  9.3369         	|
|  [TrainingEpochLoop].train_dataloader_next                                                                                                                                                                                  	|  0.0020403      	|  3908           	|  7.9735         	|  4.864          	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                                                                             	|  0.00086792     	|  5862           	|  5.0878         	|  3.1037         	|
|  [LightningModule]LightningModel.transfer_batch_to_device                                                                                                                                                                   	|  0.0007773      	|  5862           	|  4.5565         	|  2.7796         	|
|  [EvaluationEpochLoop].None_dataloader_idx_0_next                                                                                                                                                                           	|  0.0013463      	|  1954           	|  2.6307         	|  1.6048         	|
|  [LightningModule]LightningModel.optimizer_zero_grad                                                                                                                                                                        	|  0.0001706      	|  3908           	|  0.66671        	|  0.40671        	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                                             	|  0.18795        	|  2              	|  0.3759         	|  0.22931        	|
|  [LightningModule]LightningModel.validation_epoch_end                                                                                                                                                                       	|  0.25175        	|  1              	|  0.25175        	|  0.15358        	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_end                	|  2.2571e-05     	|  3908           	|  0.088207       	|  0.053809       	|
|  [LightningModule]LightningModel.configure_gradient_clipping                                                                                                                                                                	|  1.9486e-05     	|  3908           	|  0.076153       	|  0.046455       	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                                                                               	|  1.7089e-05     	|  3908           	|  0.066783       	|  0.040739       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                                          	|  1.8817e-05     	|  1954           	|  0.036768       	|  0.02243        	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                                              	|  4.5714e-06     	|  3908           	|  0.017865       	|  0.010898       	|
|  [Callback]TQDMProgressBar.on_batch_start                                                                                                                                                                                   	|  4.1221e-06     	|  3908           	|  0.016109       	|  0.009827       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                                                	|  4.0123e-06     	|  3908           	|  0.01568        	|  0.0095653      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                                               	|  3.4697e-06     	|  3908           	|  0.01356        	|  0.0082717      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                                                                                  	|  3.3504e-06     	|  3908           	|  0.013093       	|  0.0079873      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                                        	|  6.1801e-06     	|  1954           	|  0.012076       	|  0.0073667      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                                                                             	|  3.0471e-06     	|  3908           	|  0.011908       	|  0.0072642      	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                                                 	|  2.9999e-06     	|  3908           	|  0.011724       	|  0.0071517      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                                         	|  2.9685e-06     	|  3908           	|  0.011601       	|  0.0070768      	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                                                                                  	|  2.7739e-06     	|  3908           	|  0.01084        	|  0.0066129      	|
|  [Callback]TQDMProgressBar.on_batch_end                                                                                                                                                                                     	|  2.7589e-06     	|  3908           	|  0.010782       	|  0.0065772      	|
|  [Callback]GradientAccumulationScheduler.on_train_batch_end                                                                                                                                                                 	|  2.7506e-06     	|  3908           	|  0.010749       	|  0.0065574      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                                                                                   	|  2.7317e-06     	|  3908           	|  0.010675       	|  0.0065122      	|
|  [Callback]ModelSummary.on_batch_start                                                                                                                                                                                      	|  2.7236e-06     	|  3908           	|  0.010644       	|  0.0064929      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_batch_start                    	|  2.644e-06      	|  3908           	|  0.010333       	|  0.0063032      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_optimizer_step          	|  2.6136e-06     	|  3908           	|  0.010214       	|  0.0062307      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_start              	|  2.6111e-06     	|  3908           	|  0.010204       	|  0.0062248      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_zero_grad               	|  2.5996e-06     	|  3908           	|  0.010159       	|  0.0061974      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_backward                	|  2.5965e-06     	|  3908           	|  0.010147       	|  0.00619        	|
|  [LightningModule]LightningModel.on_before_batch_transfer                                                                                                                                                                   	|  1.7041e-06     	|  5862           	|  0.0099896      	|  0.0060939      	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                                  	|  2.5504e-06     	|  3908           	|  0.0099669      	|  0.0060801      	|
|  [Callback]GradientAccumulationScheduler.on_train_batch_start                                                                                                                                                               	|  2.5267e-06     	|  3908           	|  0.0098743      	|  0.0060236      	|
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                                                	|  2.5157e-06     	|  3908           	|  0.0098313      	|  0.0059973      	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                                            	|  2.5123e-06     	|  3908           	|  0.0098181      	|  0.0059893      	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                                                                                	|  2.4856e-06     	|  3908           	|  0.0097137      	|  0.0059256      	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                                     	|  2.4805e-06     	|  3908           	|  0.0096939      	|  0.0059136      	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                                 	|  2.4706e-06     	|  3908           	|  0.009655       	|  0.0058898      	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                                           	|  2.4626e-06     	|  3908           	|  0.009624       	|  0.0058709      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_after_backward                 	|  2.4558e-06     	|  3908           	|  0.0095971      	|  0.0058545      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_batch_end                      	|  2.4421e-06     	|  3908           	|  0.0095436      	|  0.0058219      	|
|  [LightningModule]LightningModel.on_after_batch_transfer                                                                                                                                                                    	|  1.614e-06      	|  5862           	|  0.0094612      	|  0.0057716      	|
|  [Callback]ModelSummary.on_batch_end                                                                                                                                                                                        	|  2.4179e-06     	|  3908           	|  0.009449       	|  0.0057642      	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                                       	|  2.3229e-06     	|  3908           	|  0.0090778      	|  0.0055377      	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                                             	|  3.2352e-06     	|  1954           	|  0.0063215      	|  0.0038563      	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                                           	|  3.0653e-06     	|  1954           	|  0.0059896      	|  0.0036538      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_start         	|  2.7192e-06     	|  1954           	|  0.0053134      	|  0.0032413      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_end           	|  2.7144e-06     	|  1954           	|  0.0053039      	|  0.0032355      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                                            	|  2.7014e-06     	|  1954           	|  0.0052785      	|  0.00322        	|
|  [LightningModule]LightningModel.training_step_end                                                                                                                                                                          	|  1.3492e-06     	|  3908           	|  0.0052729      	|  0.0032166      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                                          	|  2.5713e-06     	|  1954           	|  0.0050243      	|  0.003065       	|
|  [LightningModule]LightningModel.on_train_batch_end                                                                                                                                                                         	|  1.2132e-06     	|  3908           	|  0.0047412      	|  0.0028922      	|
|  [LightningModule]LightningModel.on_after_backward                                                                                                                                                                          	|  1.0827e-06     	|  3908           	|  0.0042311      	|  0.0025811      	|
|  [LightningModule]LightningModel.on_before_zero_grad                                                                                                                                                                        	|  1.0716e-06     	|  3908           	|  0.0041877      	|  0.0025546      	|
|  [LightningModule]LightningModel.on_train_batch_start                                                                                                                                                                       	|  1.0552e-06     	|  3908           	|  0.0041239      	|  0.0025157      	|
|  [Strategy]SingleDeviceStrategy.training_step_end                                                                                                                                                                           	|  1.0373e-06     	|  3908           	|  0.0040538      	|  0.0024729      	|
|  [LightningModule]LightningModel.on_before_backward                                                                                                                                                                         	|  9.8224e-07     	|  3908           	|  0.0038386      	|  0.0023416      	|
|  [LightningModule]LightningModel.validation_step_end                                                                                                                                                                        	|  1.766e-06      	|  1954           	|  0.0034507      	|  0.002105       	|
|  [LightningModule]LightningModel.on_before_optimizer_step                                                                                                                                                                   	|  8.754e-07      	|  3908           	|  0.0034211      	|  0.0020869      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                                                                        	|  8.1868e-07     	|  3908           	|  0.0031994      	|  0.0019517      	|
|  [Strategy]SingleDeviceStrategy.validation_step_end                                                                                                                                                                         	|  1.1551e-06     	|  1954           	|  0.0022571      	|  0.0013769      	|
|  [LightningModule]LightningModel.on_validation_batch_end                                                                                                                                                                    	|  1.1152e-06     	|  1954           	|  0.0021791      	|  0.0013293      	|
|  [LightningModule]LightningModel.on_validation_batch_start                                                                                                                                                                  	|  1.0776e-06     	|  1954           	|  0.0021056      	|  0.0012845      	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                                                                        	|  0.001489       	|  1              	|  0.001489       	|  0.00090831     	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                                               	|  0.00053779     	|  2              	|  0.0010756      	|  0.00065613     	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                                            	|  0.0010708      	|  1              	|  0.0010708      	|  0.00065323     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                                                     	|  0.00063975     	|  1              	|  0.00063975     	|  0.00039026     	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                                                	|  0.00050855     	|  1              	|  0.00050855     	|  0.00031023     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                                                   	|  0.00044897     	|  1              	|  0.00044897     	|  0.00027388     	|
|  [LightningModule]LightningModel.configure_optimizers                                                                                                                                                                       	|  0.00043656     	|  1              	|  0.00043656     	|  0.00026632     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.0003357      	|  1              	|  0.0003357      	|  0.00020478     	|
|  [LightningModule]LightningModel.on_validation_model_train                                                                                                                                                                  	|  0.00018618     	|  1              	|  0.00018618     	|  0.00011357     	|
|  [LightningModule]LightningModel.on_validation_model_eval                                                                                                                                                                   	|  0.00015172     	|  1              	|  0.00015172     	|  9.2552e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_end                	|  2.4935e-05     	|  2              	|  4.9871e-05     	|  3.0423e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_end                 	|  4.9204e-05     	|  1              	|  4.9204e-05     	|  3.0016e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                                                  	|  1.7766e-05     	|  2              	|  3.5531e-05     	|  2.1675e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                                                	|  1.3819e-05     	|  2              	|  2.7638e-05     	|  1.686e-05      	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                                                                   	|  2.3647e-05     	|  1              	|  2.3647e-05     	|  1.4425e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                                          	|  2.3308e-05     	|  1              	|  2.3308e-05     	|  1.4218e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                                               	|  9.9985e-06     	|  2              	|  1.9997e-05     	|  1.2199e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                                   	|  5.058e-06      	|  3              	|  1.5174e-05     	|  9.2565e-06     	|
|  [LightningModule]LightningModel.on_validation_epoch_end                                                                                                                                                                    	|  1.4264e-05     	|  1              	|  1.4264e-05     	|  8.7014e-06     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                                       	|  1.3173e-05     	|  1              	|  1.3173e-05     	|  8.0359e-06     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                                                                           	|  1.2674e-05     	|  1              	|  1.2674e-05     	|  7.7315e-06     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                                            	|  1.2566e-05     	|  1              	|  1.2566e-05     	|  7.6656e-06     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                                               	|  1.1978e-05     	|  1              	|  1.1978e-05     	|  7.3069e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                                  	|  1.1267e-05     	|  1              	|  1.1267e-05     	|  6.8732e-06     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                                        	|  3.7237e-06     	|  3              	|  1.1171e-05     	|  6.8146e-06     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                                                                      	|  1.0205e-05     	|  1              	|  1.0205e-05     	|  6.2253e-06     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                                                                        	|  9.698e-06      	|  1              	|  9.698e-06      	|  5.916e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_epoch_end                      	|  3.0933e-06     	|  3              	|  9.28e-06       	|  5.661e-06      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                                              	|  9.195e-06      	|  1              	|  9.195e-06      	|  5.6092e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                                 	|  4.4695e-06     	|  2              	|  8.939e-06      	|  5.453e-06      	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                                     	|  2.8783e-06     	|  3              	|  8.635e-06      	|  5.2676e-06     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                                                     	|  8.54e-06       	|  1              	|  8.54e-06       	|  5.2096e-06     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                                      	|  2.6903e-06     	|  3              	|  8.071e-06      	|  4.9235e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_epoch_start                    	|  2.639e-06      	|  3              	|  7.917e-06      	|  4.8296e-06     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                                              	|  7.679e-06      	|  1              	|  7.679e-06      	|  4.6844e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                                     	|  2.4797e-06     	|  3              	|  7.439e-06      	|  4.538e-06      	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                                       	|  2.278e-06      	|  3              	|  6.834e-06      	|  4.1689e-06     	|
|  [LightningModule]LightningModel.configure_callbacks                                                                                                                                                                        	|  6.803e-06      	|  1              	|  6.803e-06      	|  4.15e-06       	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                                       	|  6.159e-06      	|  1              	|  6.159e-06      	|  3.7571e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_start              	|  2.832e-06      	|  2              	|  5.664e-06      	|  3.4552e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_start                                                                                                                                                                        	|  5.559e-06      	|  1              	|  5.559e-06      	|  3.3911e-06     	|
|  [LightningModule]LightningModel.on_epoch_start                                                                                                                                                                             	|  1.827e-06      	|  3              	|  5.481e-06      	|  3.3436e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                                         	|  5.189e-06      	|  1              	|  5.189e-06      	|  3.1654e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_start                    	|  4.526e-06      	|  1              	|  4.526e-06      	|  2.761e-06      	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                                             	|  4.403e-06      	|  1              	|  4.403e-06      	|  2.6859e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                                        	|  4.38e-06       	|  1              	|  4.38e-06       	|  2.6719e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_start                      	|  4.346e-06      	|  1              	|  4.346e-06      	|  2.6512e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                                               	|  4.319e-06      	|  1              	|  4.319e-06      	|  2.6347e-06     	|
|  [LightningModule]LightningModel.on_train_epoch_start                                                                                                                                                                       	|  2.0165e-06     	|  2              	|  4.033e-06      	|  2.4602e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                                       	|  4.023e-06      	|  1              	|  4.023e-06      	|  2.4541e-06     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                                                                 	|  3.703e-06      	|  1              	|  3.703e-06      	|  2.2589e-06     	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                                              	|  3.581e-06      	|  1              	|  3.581e-06      	|  2.1845e-06     	|
|  [LightningModule]LightningModel.on_fit_start                                                                                                                                                                               	|  3.428e-06      	|  1              	|  3.428e-06      	|  2.0912e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                                              	|  3.357e-06      	|  1              	|  3.357e-06      	|  2.0479e-06     	|
|  [LightningModule]LightningModel.on_epoch_end                                                                                                                                                                               	|  1.1157e-06     	|  3              	|  3.347e-06      	|  2.0418e-06     	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                                              	|  3.187e-06      	|  1              	|  3.187e-06      	|  1.9442e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  3.086e-06      	|  1              	|  3.086e-06      	|  1.8825e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_start                                                                                                                                                                           	|  3.064e-06      	|  1              	|  3.064e-06      	|  1.8691e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                                       	|  3.028e-06      	|  1              	|  3.028e-06      	|  1.8472e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                                                                          	|  3.02e-06       	|  1              	|  3.02e-06       	|  1.8423e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_start             	|  3.015e-06      	|  1              	|  3.015e-06      	|  1.8392e-06     	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                                          	|  2.949e-06      	|  1              	|  2.949e-06      	|  1.799e-06      	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                                                 	|  2.94e-06       	|  1              	|  2.94e-06       	|  1.7935e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_end                      	|  2.916e-06      	|  1              	|  2.916e-06      	|  1.7788e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                                            	|  2.908e-06      	|  1              	|  2.908e-06      	|  1.774e-06      	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                                         	|  2.859e-06      	|  1              	|  2.859e-06      	|  1.7441e-06     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                                                	|  2.857e-06      	|  1              	|  2.857e-06      	|  1.7428e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_end                                                                                                                                                                          	|  2.823e-06      	|  1              	|  2.823e-06      	|  1.7221e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                                     	|  2.801e-06      	|  1              	|  2.801e-06      	|  1.7087e-06     	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                                 	|  2.789e-06      	|  1              	|  2.789e-06      	|  1.7014e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                                                	|  2.774e-06      	|  1              	|  2.774e-06      	|  1.6922e-06     	|
|  [LightningModule]LightningModel.on_train_epoch_end                                                                                                                                                                         	|  1.3735e-06     	|  2              	|  2.747e-06      	|  1.6757e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                                          	|  2.742e-06      	|  1              	|  2.742e-06      	|  1.6727e-06     	|
|  [LightningModule]LightningModel.setup                                                                                                                                                                                      	|  2.721e-06      	|  1              	|  2.721e-06      	|  1.6599e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                                            	|  2.697e-06      	|  1              	|  2.697e-06      	|  1.6452e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_configure_sharded_model        	|  2.681e-06      	|  1              	|  2.681e-06      	|  1.6355e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_pretrain_routine_start         	|  2.641e-06      	|  1              	|  2.641e-06      	|  1.6111e-06     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                                           	|  2.64e-06       	|  1              	|  2.64e-06       	|  1.6105e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.teardown                          	|  2.638e-06      	|  1              	|  2.638e-06      	|  1.6092e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_start               	|  2.634e-06      	|  1              	|  2.634e-06      	|  1.6068e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_end               	|  2.628e-06      	|  1              	|  2.628e-06      	|  1.6032e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_pretrain_routine_end           	|  2.583e-06      	|  1              	|  2.583e-06      	|  1.5757e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_start         	|  2.565e-06      	|  1              	|  2.565e-06      	|  1.5647e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_end                                                                                                                                                                             	|  2.56e-06       	|  1              	|  2.56e-06       	|  1.5617e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                                           	|  2.537e-06      	|  1              	|  2.537e-06      	|  1.5476e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                                                	|  2.528e-06      	|  1              	|  2.528e-06      	|  1.5421e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                                         	|  2.521e-06      	|  1              	|  2.521e-06      	|  1.5379e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_end                        	|  2.48e-06       	|  1              	|  2.48e-06       	|  1.5129e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                                            	|  2.464e-06      	|  1              	|  2.464e-06      	|  1.5031e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'validation_f1_score', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_end           	|  2.463e-06      	|  1              	|  2.463e-06      	|  1.5025e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                                          	|  2.412e-06      	|  1              	|  2.412e-06      	|  1.4714e-06     	|
|  [LightningDataModule]DataModule.teardown                                                                                                                                                                                   	|  2.387e-06      	|  1              	|  2.387e-06      	|  1.4561e-06     	|
|  [LightningModule]LightningModel.configure_sharded_model                                                                                                                                                                    	|  2.305e-06      	|  1              	|  2.305e-06      	|  1.4061e-06     	|
|  [LightningDataModule]DataModule.prepare_data                                                                                                                                                                               	|  2.288e-06      	|  1              	|  2.288e-06      	|  1.3957e-06     	|
|  [LightningModule]LightningModel.on_validation_end                                                                                                                                                                          	|  1.647e-06      	|  1              	|  1.647e-06      	|  1.0047e-06     	|
|  [LightningModule]LightningModel.on_fit_end                                                                                                                                                                                 	|  1.625e-06      	|  1              	|  1.625e-06      	|  9.9129e-07     	|
|  [LightningModule]LightningModel.on_train_end                                                                                                                                                                               	|  1.578e-06      	|  1              	|  1.578e-06      	|  9.6262e-07     	|
|  [LightningModule]LightningModel.on_train_start                                                                                                                                                                             	|  1.504e-06      	|  1              	|  1.504e-06      	|  9.1748e-07     	|
|  [LightningModule]LightningModel.on_validation_start                                                                                                                                                                        	|  1.481e-06      	|  1              	|  1.481e-06      	|  9.0345e-07     	|
|  [LightningModule]LightningModel.on_pretrain_routine_start                                                                                                                                                                  	|  1.267e-06      	|  1              	|  1.267e-06      	|  7.729e-07      	|
|  [LightningModule]LightningModel.prepare_data                                                                                                                                                                               	|  1.231e-06      	|  1              	|  1.231e-06      	|  7.5094e-07     	|
|  [LightningModule]LightningModel.on_validation_epoch_start                                                                                                                                                                  	|  1.135e-06      	|  1              	|  1.135e-06      	|  6.9238e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                                                                              	|  1.087e-06      	|  1              	|  1.087e-06      	|  6.631e-07      	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                                                                         	|  1.084e-06      	|  1              	|  1.084e-06      	|  6.6127e-07     	|
|  [LightningModule]LightningModel.teardown                                                                                                                                                                                   	|  1.079e-06      	|  1              	|  1.079e-06      	|  6.5822e-07     	|
|  [LightningModule]LightningModel.on_pretrain_routine_end                                                                                                                                                                    	|  1.078e-06      	|  1              	|  1.078e-06      	|  6.5761e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                                                                	|  9.2e-07        	|  1              	|  9.2e-07        	|  5.6122e-07     	|

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1954/1954 [00:34<00:00, 56.71it/s, loss=0.605, v_num=78k3]